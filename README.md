# SUNSTAR Modbus RTU 雙控制器監控調整程式

這是一個使用 Python、Tkinter、ttkbootstrap 和 modbus-tk 開發的桌面應用程式，用於監控和調整基於 Modbus RTU 協議的 SUNSTAR 雙控制器。

## 主要功能

*   **Modbus RTU 通訊**：通過串口連接到控制器，讀取和寫入寄存器。
*   **雙語介面**：支援中文和英文之間的即時切換。
*   **即時監控**：
    *   使用 `ttkbootstrap` 的 `Meter` 元件以圖形化方式顯示 A 組和 B 組的輸出電流和輸入信號。
    *   即時顯示控制器狀態（正常、開路、短路等）。
*   **參數讀寫**：
    *   以分頁形式清晰地組織了通用參數、A 組參數、B 組參數和 PID 參數。
    *   支援單個參數的即時寫入和所有參數的批量寫入。
    *   提供「恢復出廠設置」功能，並有安全確認提示。
*   **參數管理**：
    *   可以將當前所有參數保存為本地 JSON 檔案。
    *   可以從本地檔案讀取參數配置並應用到介面。
    *   提供刪除已保存參數檔案的功能。
*   **動態圖表**：
    *   根據不同的控制器工作模式（單組輸出、雙組信號-雙組輸出、單組信號-雙組輸出）即時繪製輸出特性曲線。
    *   圖表會根據相關參數（如最大/最小電流、指令死區等）動態更新。
    *   圖表的 X 軸會根據信號源（類比信號或 RS485）動態顯示不同的單位（V, mA, %）。
*   **介面優化**：
    *   採用 `ttkbootstrap` 的 `litera` 主題，美觀易用。
    *   對參數顯示、按鈕佈局等進行了優化，以提高用戶體驗。

## 如何使用

1.  **安裝依賴**:
    ```bash
    pip install ttkbootstrap modbus-tk pyserial
    ```
2.  **運行程式**:
    ```bash
    python dual_controller_app.py
    ```
3.  **連接控制器**:
    *   在「Modbus通訊參數設置」區域選擇正確的通訊端口、鮑率和設備位址。
    *   點擊「連接」按鈕。
4.  **操作**:
    *   連接成功後，程式會自動讀取所有參數並更新介面。
    *   在「可寫入參數」區修改參數，點擊「套用至控制器」進行批量寫入。
    *   使用「本地儲存」和「本地讀取」功能來管理不同的參數配置。

## 螢幕截圖

<img width="1202" height="1032" alt="image" src="https://github.com/user-attachments/assets/51e04fba-3dfd-44c7-8e27-916826353510" />
